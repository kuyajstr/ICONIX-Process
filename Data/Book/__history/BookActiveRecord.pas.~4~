unit BookActiveRecord;

interface

uses
  MVCFramework.ActiveRecord, Book, BookContextIntf,
  MVCFramework.Serializer.Commons,
  MVCFramework.SQLGenerators.MySQL;

type

  [MVCTable('books')]
  TBookActiveRecord = class(TMVCActiveRecord, IBookContext)
  private
    [MVCTableField('ID', [foPrimaryKey, foAutoGenerated])]
    FId: Integer;
    [MVCTableField('TITLE')]
    FTitle: string;
    [MVCTableField('SYNOPSIS')]
    FSynopsis: string;

    function GetId: Integer;
    procedure SetId(const AId: Integer);

    function GetTitle: string;
    procedure SetTitle(const ATitle: string);

    function GetSynopsis: string;
    procedure SetSynopsis(const ASynopsis: string);
  public
    constructor Create; overload;
    constructor Create(const ABook: TBook); overload;

    property Id: Integer read GetId write SetId;
    property Title: string read GetTitle write SetTitle;
    property Synopsis: string read GetSynopsis write SetSynopsis;

    function QueryInterface(const IID: TGUID; out Obj): HRESULT; stdcall;
    function _AddRef: Integer; stdcall;
    function _Release: Integer; stdcall;
  end;

implementation

{ TBookActiveRecord }

constructor TBookActiveRecord.Create(const ABook: TBook);
begin
  inherited Create(True);

  ID := ABook.Id;
  Title := ABook.Title;
  Synopsis := ABook.Synopsis;
end;

constructor TBookActiveRecord.Create;
begin
  inherited Create(True);
end;

function TBookActiveRecord.GetId: Integer;
begin
  Result := FId;
end;

function TBookActiveRecord.GetSynopsis: string;
begin
  Result := FSynopsis;
end;

function TBookActiveRecord.GetTitle: string;
begin
  Result := FTitle;
end;

procedure TBookActiveRecord.SetId(const AId: Integer);
begin
  FId := AId;
end;

procedure TBookActiveRecord.SetSynopsis(const ASynopsis: string);
begin
  FSynopsis := ASynopsis;
end;

procedure TBookActiveRecord.SetTitle(const ATitle: string);
begin
  FTitle := ATitle;
end;

function TBookActiveRecord.QueryInterface(const IID: TGUID; out Obj): HRESULT;
begin
  Result := -1;
end;

function TBookActiveRecord._AddRef: Integer;
begin
  Result := -1;
end;

function TBookActiveRecord._Release: Integer;
begin
  Result := -1;
end;

end.
